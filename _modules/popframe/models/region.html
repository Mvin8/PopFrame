<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>popframe.models.region &mdash; PopFrame 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PopFrame
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../popframe/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../popframe/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about_us.html">About us</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PopFrame</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">popframe.models.region</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for popframe.models.region</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">singledispatchmethod</span>
<span class="kn">import</span> <span class="nn">dill</span> <span class="k">as</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">pyproj</span>
<span class="kn">import</span> <span class="nn">shapely</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">.town</span> <span class="kn">import</span> <span class="n">Town</span>
<span class="kn">from</span> <span class="nn">.territory</span> <span class="kn">import</span> <span class="n">Territory</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">DISTRICTS_PLOT_COLOR</span> <span class="o">=</span> <span class="s1">&#39;#28486d&#39;</span>
<span class="n">SETTLEMENTS_PLOT_COLOR</span> <span class="o">=</span> <span class="s1">&#39;#ddd&#39;</span>
<span class="n">TOWNS_PLOT_COLOR</span> <span class="o">=</span> <span class="s1">&#39;#333333&#39;</span>
<span class="n">TERRITORIES_PLOT_COLOR</span> <span class="o">=</span> <span class="s1">&#39;#893434&#39;</span>

<div class="viewcode-block" id="Region"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region">[docs]</a><span class="k">class</span> <span class="nc">Region</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing a geographical region that includes districts, settlements, towns, and optionally territories.</span>
<span class="sd">    Provides methods for validating and visualizing spatial data, as well as for calculating accessibility between towns.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    crs : pyproj.CRS</span>
<span class="sd">        Coordinate Reference System of the region.</span>
<span class="sd">    region : gpd.GeoDataFrame</span>
<span class="sd">        GeoDataFrame representing the boundaries of the region.</span>
<span class="sd">    districts : gpd.GeoDataFrame</span>
<span class="sd">        GeoDataFrame containing information about districts.</span>
<span class="sd">    settlements : gpd.GeoDataFrame</span>
<span class="sd">        GeoDataFrame containing information about settlements.</span>
<span class="sd">    _towns : dict</span>
<span class="sd">        Dictionary containing `Town` objects indexed by their IDs.</span>
<span class="sd">    accessibility_matrix : pd.DataFrame</span>
<span class="sd">        DataFrame containing accessibility data between towns.</span>
<span class="sd">    _territories : dict</span>
<span class="sd">        Dictionary containing `Territory` objects indexed by their IDs (optional).</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    validate_districts(gdf: gpd.GeoDataFrame) -&gt; gpd.GeoDataFrame</span>
<span class="sd">        Validates the structure and content of a districts GeoDataFrame.</span>
<span class="sd">        </span>
<span class="sd">    validate_settlements(gdf: gpd.GeoDataFrame) -&gt; gpd.GeoDataFrame</span>
<span class="sd">        Validates the structure and content of a settlements GeoDataFrame.</span>
<span class="sd">        </span>
<span class="sd">    validate_towns(gdf: gpd.GeoDataFrame) -&gt; gpd.GeoDataFrame</span>
<span class="sd">        Validates the structure and content of a towns GeoDataFrame.</span>
<span class="sd">        </span>
<span class="sd">    validate_region(gdf: gpd.GeoDataFrame) -&gt; gpd.GeoDataFrame</span>
<span class="sd">        Validates the structure and content of a region GeoDataFrame.</span>
<span class="sd">        </span>
<span class="sd">    validate_accessibility_matrix(df: pd.DataFrame) -&gt; pd.DataFrame</span>
<span class="sd">        Validates the structure and content of the accessibility matrix.</span>
<span class="sd">    </span>
<span class="sd">    plot(figsize=(15, 15))</span>
<span class="sd">        Visualizes the region, including districts, settlements, towns, and optionally territories.</span>

<span class="sd">    get_territory(territory_id: int) -&gt; Territory</span>
<span class="sd">        Retrieves a territory by its ID.</span>
<span class="sd">    </span>
<span class="sd">    towns() -&gt; list[Town]</span>
<span class="sd">        Returns a list of all towns in the region.</span>
<span class="sd">    </span>
<span class="sd">    territories() -&gt; list[Territory]</span>
<span class="sd">        Returns a list of all territories in the region.</span>

<span class="sd">    geometry() -&gt; shapely.Polygon | shapely.MultiPolygon</span>
<span class="sd">        Returns the unified geometry of all districts in the region.</span>
<span class="sd">    </span>
<span class="sd">    get_territories_gdf() -&gt; gpd.GeoDataFrame</span>
<span class="sd">        Returns a GeoDataFrame representing all territories in the region.</span>
<span class="sd">    </span>
<span class="sd">    get_towns_gdf() -&gt; gpd.GeoDataFrame</span>
<span class="sd">        Returns a GeoDataFrame representing all towns in the region.</span>

<span class="sd">    __getitem__(arg)</span>
<span class="sd">        Overloads the subscript operator to access a town or accessibility data based on the argument type.</span>
<span class="sd">    </span>
<span class="sd">    from_pickle(file_path: str) -&gt; Region</span>
<span class="sd">        Loads a `Region` object from a .pickle file.</span>
<span class="sd">    </span>
<span class="sd">    to_pickle(file_path: str)</span>
<span class="sd">        Saves the `Region` object to a .pickle file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> 
            <span class="n">region</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> 
            <span class="n">districts</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> 
            <span class="n">settlements</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> 
            <span class="n">towns</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> 
            <span class="n">accessibility_matrix</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
            <span class="n">territories</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the Region object with GeoDataFrames for region, districts, settlements, and towns. </span>
<span class="sd">        Optionally includes territories and an accessibility matrix to model transportation between towns.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        region : gpd.GeoDataFrame</span>
<span class="sd">            GeoDataFrame representing the boundaries of the region.</span>
<span class="sd">        districts : gpd.GeoDataFrame</span>
<span class="sd">            GeoDataFrame containing information about districts.</span>
<span class="sd">        settlements : gpd.GeoDataFrame</span>
<span class="sd">            GeoDataFrame containing information about settlements.</span>
<span class="sd">        towns : gpd.GeoDataFrame</span>
<span class="sd">            GeoDataFrame containing information about towns.</span>
<span class="sd">        accessibility_matrix : pd.DataFrame</span>
<span class="sd">            DataFrame containing accessibility data between towns.</span>
<span class="sd">        territories : gpd.GeoDataFrame, optional</span>
<span class="sd">            GeoDataFrame containing information about territories (default is None).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AssertionError</span>
<span class="sd">            If the CRS or indices between the towns and the accessibility matrix do not match.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_region</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
        <span class="n">districts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_districts</span><span class="p">(</span><span class="n">districts</span><span class="p">)</span>
        <span class="n">settlements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_settlements</span><span class="p">(</span><span class="n">settlements</span><span class="p">)</span>
        <span class="n">towns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_towns</span><span class="p">(</span><span class="n">towns</span><span class="p">)</span>
        <span class="n">accessibility_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_accessibility_matrix</span><span class="p">(</span><span class="n">accessibility_matrix</span><span class="p">)</span>

        <span class="k">assert</span> <span class="p">(</span><span class="n">accessibility_matrix</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">towns</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Accessibility matrix indices and towns indices don&#39;t match&quot;</span>
        <span class="k">assert</span> <span class="n">region</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="n">districts</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="n">settlements</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="n">towns</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="s1">&#39;CRS should match everywhere&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">towns</span><span class="o">.</span><span class="n">crs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">districts</span> <span class="o">=</span> <span class="n">districts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settlements</span> <span class="o">=</span> <span class="n">settlements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_towns</span> <span class="o">=</span> <span class="n">Town</span><span class="o">.</span><span class="n">from_gdf</span><span class="p">(</span><span class="n">towns</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accessibility_matrix</span> <span class="o">=</span> <span class="n">accessibility_matrix</span>
        <span class="k">if</span> <span class="n">territories</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_territories</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">territories</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="n">towns</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="s1">&#39;Territories CRS should match towns CRS&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_territories</span> <span class="o">=</span> <span class="n">Territory</span><span class="o">.</span><span class="n">from_gdf</span><span class="p">(</span><span class="n">territories</span><span class="p">)</span>


<div class="viewcode-block" id="Region.validate_districts"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.validate_districts">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate_districts</span><span class="p">(</span><span class="n">gdf</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the districts GeoDataFrame to ensure it has the correct structure and data types.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        gdf : gpd.GeoDataFrame</span>
<span class="sd">            The GeoDataFrame containing district data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gpd.GeoDataFrame</span>
<span class="sd">            Validated GeoDataFrame with &#39;geometry&#39; and &#39;name&#39; columns.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AssertionError</span>
<span class="sd">            If the GeoDataFrame is not of the expected format or types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">),</span> <span class="s1">&#39;Districts should be instance of gpd.GeoDataFrame&#39;</span>
        <span class="k">assert</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geom_type</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;MultiPolygon&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s1">&#39;District geometry should be Polygon or MultiPolygon&#39;</span>
        <span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_string_dtype</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="s1">&#39;District name should be str&#39;</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="Region.validate_settlements"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.validate_settlements">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate_settlements</span><span class="p">(</span><span class="n">gdf</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the settlements GeoDataFrame to ensure it has the correct structure and data types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">),</span> <span class="s1">&#39;Settlements should be instance of gpd.GeoDataFrame&#39;</span>
        <span class="k">assert</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geom_type</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;MultiPolygon&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s1">&#39;Settlement geometry should be Polygon or MultiPolygon&#39;</span>
        <span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_string_dtype</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="s1">&#39;Settlement name should be str&#39;</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]]</span></div>
    
<div class="viewcode-block" id="Region.validate_towns"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.validate_towns">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate_towns</span><span class="p">(</span><span class="n">gdf</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the towns GeoDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">),</span> <span class="s1">&#39;Towns should be instance of gpd.GeoDataFrame&#39;</span>
        <span class="k">return</span> <span class="n">gdf</span></div>

<div class="viewcode-block" id="Region.validate_region"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.validate_region">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate_region</span><span class="p">(</span><span class="n">gdf</span> <span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the region GeoDataFrame to ensure it has the correct structure and data types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">),</span> <span class="s1">&#39;Region should be instance of gpd.GeoDataFrame&#39;</span>
        <span class="k">assert</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geom_type</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;MultiPolygon&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s1">&#39;District geometry should be Polygon or MultiPolygon&#39;</span>
        <span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_string_dtype</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="s1">&#39;District name should be str&#39;</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]]</span></div>
    
<div class="viewcode-block" id="Region.validate_accessibility_matrix"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.validate_accessibility_matrix">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate_accessibility_matrix</span><span class="p">(</span><span class="n">df</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the accessibility matrix, ensuring it has non-negative float values </span>
<span class="sd">        and matching row and column indices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_float_dtype</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="s1">&#39;Accessibility matrix values should be float&#39;</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s1">&#39;Accessibility matrix values should be greater or equal 0&#39;</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Accessibility matrix indices and columns don&#39;t match&quot;</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="Region.plot"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the region, including districts, settlements, towns, and optionally territories, on a map.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figsize : tuple, optional</span>
<span class="sd">            The size of the plot (default is (15, 15)).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sett_to_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settlements</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sett_to_dist</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">sett_to_dist</span><span class="o">.</span><span class="n">representative_point</span><span class="p">()</span>
        <span class="n">sett_to_dist</span> <span class="o">=</span> <span class="n">sett_to_dist</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">districts</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;name_right&#39;</span><span class="p">:</span> <span class="s1">&#39;district_name&#39;</span><span class="p">,</span>
            <span class="s1">&#39;index_right&#39;</span><span class="p">:</span> <span class="s1">&#39;district_id&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name_left&#39;</span><span class="p">:</span> <span class="s1">&#39;settlement_name&#39;</span>
        <span class="p">})</span>
        <span class="n">sett_to_dist</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settlements</span><span class="o">.</span><span class="n">geometry</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="c1"># Plot settlements</span>
        <span class="n">sett_to_dist</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">SETTLEMENTS_PLOT_COLOR</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Settlements&#39;</span><span class="p">)</span>

        <span class="c1"># Plot towns</span>
        <span class="n">towns_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_towns_gdf</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">TOWNS_PLOT_COLOR</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Towns&#39;</span><span class="p">)</span>

        <span class="c1"># Plot districts</span>
        <span class="n">districts_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">districts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">DISTRICTS_PLOT_COLOR</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Districts&#39;</span><span class="p">)</span>
        
        <span class="c1"># Plot territories</span>
        <span class="n">territories_gdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_territories_gdf</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">territories_gdf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">territories_gdf</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">territories_gdf</span><span class="o">.</span><span class="n">representative_point</span><span class="p">()</span>
            <span class="n">territories_plot</span> <span class="o">=</span> <span class="n">territories_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">TERRITORIES_PLOT_COLOR</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Territories&#39;</span><span class="p">)</span>

        <span class="c1"># Additional settings for better visualization</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

        <span class="c1"># Create legend with smaller markers</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markerscale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">handletextpad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Region model&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="Region.get_territory"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.get_territory">[docs]</a>    <span class="k">def</span> <span class="nf">get_territory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">territory_id</span> <span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a specific territory by its ID.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        territory_id : int</span>
<span class="sd">            The ID of the territory.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Territory</span>
<span class="sd">            The requested territory.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If the territory with the given ID is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">territory_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_territories</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t find territory with such id: </span><span class="si">{</span><span class="n">territory_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_territories</span><span class="p">[</span><span class="n">territory_id</span><span class="p">]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">towns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Town</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all towns in the region.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[Town]</span>
<span class="sd">            List of Town objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_towns</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">territories</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Territory</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all territories in the region.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[Territory]</span>
<span class="sd">            List of Territory objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_territories</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">shapely</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">|</span> <span class="n">shapely</span><span class="o">.</span><span class="n">MultiPolygon</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the unified geometry of all districts in the region, transformed to the WGS84 CRS (EPSG:4326).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        shapely.Polygon or shapely.MultiPolygon</span>
<span class="sd">            The unified geometry of the region.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">districts</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="mi">4326</span><span class="p">)</span><span class="o">.</span><span class="n">unary_union</span>

<div class="viewcode-block" id="Region.get_territories_gdf"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.get_territories_gdf">[docs]</a>    <span class="k">def</span> <span class="nf">get_territories_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a GeoDataFrame representing all territories in the region.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gpd.GeoDataFrame</span>
<span class="sd">            GeoDataFrame with territory data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">territory</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">territory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">territories</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Region.get_towns_gdf"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.get_towns_gdf">[docs]</a>    <span class="k">def</span> <span class="nf">get_towns_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a GeoDataFrame representing all towns in the region, including their relationships with settlements and districts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gpd.GeoDataFrame</span>
<span class="sd">            GeoDataFrame with town data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">town</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">town</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">towns</span><span class="p">]</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settlements</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;settlement_name&#39;</span><span class="p">}),</span> 
            <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">predicate</span><span class="o">=</span><span class="s1">&#39;within&#39;</span><span class="p">,</span>
            <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;town&#39;</span><span class="p">,</span>
            <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;settlement&#39;</span>
        <span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">districts</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;district_name&#39;</span><span class="p">}),</span>
            <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">predicate</span><span class="o">=</span><span class="s1">&#39;within&#39;</span><span class="p">,</span>
            <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;town&#39;</span><span class="p">,</span>
            <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;district&#39;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index_settlement&#39;</span><span class="p">,</span> <span class="s1">&#39;index_district&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Region.__getitem__"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.__getitem__">[docs]</a>    <span class="nd">@singledispatchmethod</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overloaded subscript operator to access a town or accessibility data based on the argument type.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        arg : int or tuple</span>
<span class="sd">            Integer to access a town by its ID, or tuple to retrieve accessibility data between two towns.</span>
<span class="sd">        </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If the argument type is unsupported.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t access object with such argument type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    <span class="c1"># Make city_model subscriptable, to access block via ID like city_model[123]</span>
    <span class="nd">@__getitem__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">town_id</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">town_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_towns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t find town with such id: </span><span class="si">{</span><span class="n">town_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_towns</span><span class="p">[</span><span class="n">town_id</span><span class="p">]</span>

    <span class="nd">@__getitem__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="nb">tuple</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">towns</span><span class="p">):</span>
        <span class="p">(</span><span class="n">town_a</span><span class="p">,</span> <span class="n">town_b</span><span class="p">)</span> <span class="o">=</span> <span class="n">towns</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">town_a</span><span class="p">,</span> <span class="n">Town</span><span class="p">):</span>
            <span class="n">town_a</span> <span class="o">=</span> <span class="n">town_a</span><span class="o">.</span><span class="n">id</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">town_b</span><span class="p">,</span> <span class="n">Town</span><span class="p">):</span>
            <span class="n">town_b</span> <span class="o">=</span> <span class="n">town_b</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessibility_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">town_a</span><span class="p">,</span> <span class="n">town_b</span><span class="p">]</span>
    
<div class="viewcode-block" id="Region.from_pickle"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.from_pickle">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_pickle</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a Region object from a .pickle file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_path : str</span>
<span class="sd">            Path to the .pickle file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Region</span>
<span class="sd">            The loaded Region object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span></div>

<div class="viewcode-block" id="Region.to_pickle"><a class="viewcode-back" href="../../../api/_autosummary/popframe.models.region.html#popframe.models.region.Region.to_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the Region object to a .pickle file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_path : str</span>
<span class="sd">            Path to the .pickle file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2024, IDU.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>